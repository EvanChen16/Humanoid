<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<link rel="SHORTCUT ICON" href="./picture/icon.png">

	<!-- CSS References -->
	<link rel="stylesheet" type="text/css" rel="stylesheet" href="./css/style.css">

	<!-- JavaScript References -->
	<script type="text/javascript" src="./js/roslib/eventemitter2.min.js"></script>
	<script type="text/javascript" src="./js/roslib/roslib.min.js"></script>
	<script type="text/javascript" type="text/javascript">

		var wasOnline = true;
		var ros = new ROSLIB.Ros({
		url: "ws://172.17.121.10:9090"
		});

		function checkConnection() {
			if (ros && window.navigator.onLine) {
				document.body.style.backgroundImage = 'url(./picture/Background.jpg)';
				console.log('Setting background to online image');
				if(!wasOnline){
					console.log("Network status changed to online. Triggering enterAddress().");
					enterAddress();
					wasOnline = true;
				}

			}else{
				document.body.style.backgroundImage = 'url(./picture/Background.jpg)';
				console.log('Setting background to offline image');
				if(wasOnline){
					console.log("Network status changed to offline. Triggering enterAddress().");
					enterAddress();
					wasOnline = false;
				}
				wasOnline = false;
			}	
		}
		

		// Listen to online and offline events
		window.addEventListener('online', checkConnection);
		window.addEventListener('offline', checkConnection);

		ros.on('connection', function () {
			console.log('Connection made!');
			connectFlag = true;
			document.getElementById('connected').style.display = 'inline';
			document.getElementById("orign_image").style.display = 'inline';
			document.getElementById("color_image").style.display = 'inline';
			checkConnectionInterval = setInterval(checkConnection, 10);
		});
		ros.on('error', function (error) {
			console.log('Error connecting to websocket server: ', error);
			document.getElementById('connected').style.display = 'none';
			
			document.body.style.backgroundImage = 'url(./picture/red_filter_image.jpg)';
			clearInterval(checkConnectionInterval);
		});
		ros.on('close', function () {
			console.log('Connection to websocket server closed.');
			B_Measure_Flag = true;
			document.getElementById("color_image").style.display = 'none';
			document.getElementById("orign_image").style.display = 'none';
			document.getElementById('connected').style.display = 'none';
			
			document.body.style.backgroundImage = 'url(./picture/red_filter_image.jpg)';
			clearInterval(checkConnectionInterval);
		});
		

		var ColorModelForm_Topic = new ROSLIB.Topic({
			ros: ros,
			name: '/ColorModelForm_Topic',
			messageType: 'tku_msgs/ButtonColorForm'
		});
		var ColorFormcmd = new ROSLIB.Message({
			buildingmodel: false
		});

		var HSVValue_Topic = new ROSLIB.Topic({
			ros: ros,
			name: '/HSVValue_Topic',
			messageType: 'tku_msgs/HSVValue'
		});
		var HSVValuecmd = new ROSLIB.Message({
			hmax: 360,
			hmin: 0,
			smax: 100,
			smin: 0,
			vmax: 100,
			vmin: 0
		});

		var Head_Topic = new ROSLIB.Topic({
			ros: ros,
			name: '/package/HeadMotor',
			messageType: 'tku_msgs/HeadPackage'
		});
		var HeadPackagecmd = new ROSLIB.Message({
			ID: 0,
			Position: 511,
			Speed: 1
		});
		var imageRawTopic = new ROSLIB.Topic({
			ros: ros,
			name: '/camera_Topic', // Change this to the actual topic name
			messageType: 'tku_msgs/Camera'
		});
		var Camera = new ROSLIB.Topic({
			ros: ros,
			name: '/Camera_Topic',
			messageType: 'tku_msgs/Camera'
		});
		var CameraMsg = new ROSLIB.Message({
			brightness: 0.5,
			contrast: 0.5,
			saturation: 0.5,
			whitebalance: 0.5,
			autowhitebalance: false,
			auto_exposure: false,
			// autoBacklightCompensation: false
		});

		var WebStart_Topic = new ROSLIB.Topic({
			ros: ros,
			name: '/web/start',
			messageType: 'std_msgs/Bool'
		});
		var WebStartcmd = new ROSLIB.Message({
			data: false
		});
		
		var CameraId_Topic = new ROSLIB.Topic({
			ros: ros,
			name: '/CameraId',
			messageType: 'std_msgs/Int16'
		});
		var CameraId_msg = new ROSLIB.Message({
			data: 0
		});

		var HSVClient = new ROSLIB.Service({
			ros: ros,
			name: '/LoadHSVInfo',
			serviceType: 'tku_msgs/HSVInfo'
		});
		var HSVreqrest = new ROSLIB.ServiceRequest({
			colorlabel: 1
		});

		var BuildClient = new ROSLIB.Service({
			ros: ros,
			name: '/BuildModel',
			serviceType: 'tku_msgs/BuildModel'
		});
		var Buildreqrest = new ROSLIB.ServiceRequest({
			build: true
		});

		var paramClient = new ROSLIB.Param({
			ros: ros,
			name: '/location'
		});

		// var SaveHSVClient
		// var SaveHSVreqrest

		// paramClient.get(function(value) {
		// 	console.log('/location 參數的值：', value);

		var SaveHSVClient = new ROSLIB.Service({
			ros: ros,
			name: '/SaveHSV',
			serviceType: 'tku_msgs/SaveHSV'
		});
		var SaveHSVreqrest = new ROSLIB.ServiceRequest({
			save: true,
			// location:value
		});
		// });

		var CameraInfoClient = new ROSLIB.Service({
			ros: ros,
			name: '/CameraInfo',
			serviceType: 'tku_msgs/CameraInfo'
		});
		var LoadCamerareqrest = new ROSLIB.ServiceRequest({
			load: true
		});

		//-----
		var connectFlag = false;
		var myAddress = "172.17.121.10";

		var B_ColorModelForm_Flag = true;
		var B_SetupCamera_Flag = true;
		var B_Start_Flag = true;

		var hmin = 0;
		var hmax = 360;
		var smin = 0;
		var smax = 100;
		var bmin = 0;
		var bmax = 100;

		var CamBrightnessValue = 0;
		var CamContrastValue = 0;
		var CamSaturationValue = 0;
		var CamWhiteBalanceValue = 0;
		var CamautowhitebalanceValue = false;
		var Camauto_exposureValue = false;

		function enterAddress() {
			if(connectFlag)
			{
				ros.close();
				connectFlag = false;
			}
			console.log("connect is",connectFlag)
			myAddress = document.getElementById("addressSelect").value;
			console.log("Connecting address is", myAddress)
			ros.connect("ws://" + myAddress + ":9090");
			document.getElementById("orign_image").src = "http://" + myAddress + ":8080/stream?topic=/image_raw";
			document.getElementById("color_image").src = "http://" + myAddress + ":8080/stream?topic=/processed_image";
		}
		// http://0.0.0.0:8080/stream_viewer?topic=/image_raw
		function ResetColorModelFunction() {
			document.getElementById("hminRange").value = 0;
			document.getElementById("sminRange").value = 0;
			document.getElementById("bminRange").value = 0;
			document.getElementById("hmaxRange").value = 360;
			document.getElementById("smaxRange").value = 255;
			document.getElementById("bmaxRange").value = 255;
			document.getElementById("hminValue").value = 0;
			document.getElementById("sminValue").value = 0;
			document.getElementById("bminValue").value = 0;
			document.getElementById("hmaxValue").value = 360;
			document.getElementById("smaxValue").value = 255;
			document.getElementById("bmaxValue").value = 255;
			hmin = 0;
			hmax = 360;
			smin = 0;
			smax = 255;
			bmin = 0;
			bmax = 255;
			HSVValuecmd.hmax = Number(hmax);
			HSVValuecmd.hmin = Number(hmin);
			HSVValuecmd.smax = Number(smax);
			HSVValuecmd.smin = Number(smin);
			HSVValuecmd.vmax = Number(bmax);
			HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
			console.log("ResetColorModelFunction");
		}
		function CloseColorModelFunction() {
			document.getElementById("hminRange").value = 0;
			document.getElementById("sminRange").value = 0;
			document.getElementById("bminRange").value = 0;
			document.getElementById("hmaxRange").value = 0;
			document.getElementById("smaxRange").value = 0;
			document.getElementById("bmaxRange").value = 0;
			document.getElementById("hminValue").value = 0;
			document.getElementById("sminValue").value = 0;
			document.getElementById("bminValue").value = 0;
			document.getElementById("hmaxValue").value = 0;
			document.getElementById("smaxValue").value = 0;
			document.getElementById("bmaxValue").value = 0;
			hmin = 0;
			hmax = 0;
			smin = 0;
			smax = 0;
			bmin = 0;
			bmax = 0;
			HSVValuecmd.hmax = Number(hmax);
			HSVValuecmd.hmin = Number(hmin);
			HSVValuecmd.smax = Number(smax);
			HSVValuecmd.smin = Number(smin);
			HSVValuecmd.vmax = Number(bmax);
			HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
			console.log("CloseColorModelFunction");
		}
		function SaveColorModelFunction() {
			// SaveHSVreqrest = new ROSLIB.ServiceRequest({
			// 	save: true,
			// 	location: value
			// });
			console.log("SaveColorModelFunction");
			SaveHSVreqrest.save = true;
			document.getElementById("SaveColorModel").disabled = "disabled";
			SaveHSVClient.callService(SaveHSVreqrest, function (SaveHSVresult) {
				if (SaveHSVresult.already == true) {
					document.getElementById("SaveColorModel").disabled = false;
				}
			});
		}
		function BuildColorModelFunction() {
			console.log("BuildColorModelFunction");
			Buildreqrest.build = true;
			console.log("build is = ", Buildreqrest.already);
			document.getElementById("BuildColorModel").disabled = "disabled";
			BuildClient.callService(Buildreqrest, function (Buildresult) {
				if (Buildresult.already == true) {
					document.getElementById("BuildColorModel").disabled = false;
				}
			});
		}
		function ColorModelForm() {
			if (B_ColorModelForm_Flag) {
				document.getElementById("HSV_Range").style.display = "inline";
				document.getElementById("B_ColorModelForm").value = "Close Model Form";
				document.getElementById("container").style.height = "710px";
				document.getElementById("select").style.height = "400px";
				changecolorlabel(document.getElementById("colorlabel").value);
				B_ColorModelForm_Flag = false;
				ColorFormcmd.buildingmodel = true;
				ColorModelForm_Topic.publish(ColorFormcmd);
			} else {
				document.getElementById("HSV_Range").style.display = "none";
				document.getElementById("B_ColorModelForm").value = "Show Model Form";
				if (B_SetupCamera_Flag == false) {
					document.getElementById("container").style.height = "810px";
					document.getElementById("select").style.height = "400px";
				} else {
					document.getElementById("container").style.height = "500px";
					document.getElementById("select").style.height = "180px";
				}
				B_ColorModelForm_Flag = true; 
				ColorFormcmd.buildingmodel = false;
				ColorModelForm_Topic.publish(ColorFormcmd);
			}
		}
		function CameraSetUp() {
			if (B_SetupCamera_Flag) {
				CameraInfoClient.callService(LoadCamerareqrest, function (LoadCameraresult) {
					console.log("white_balance: ", LoadCameraresult.white_balance);
					console.log("auto_white_balance: ", LoadCameraresult.auto_white_balance);
					console.log("auto_exposure: ", LoadCameraresult.auto_exposure);
					console.log("LoadCameraresult: ", LoadCameraresult);
					CamBrightnessValue = LoadCameraresult.brightness;
					CamContrastValue = LoadCameraresult.contrast;
					CamSaturationValue = LoadCameraresult.saturation;
					CamWhiteBalanceValue = LoadCameraresult.white_balance;
					CamautowhitebalanceValue = LoadCameraresult.auto_white_balance;
					Camauto_exposureValue = LoadCameraresult.auto_exposure;
					
					document.getElementById("CamBrightness").value = CamBrightnessValue;
					document.getElementById("CamBrightnessValue").value = CamBrightnessValue;
					document.getElementById("CamContrast").value = CamContrastValue;
					document.getElementById("CamContrastValue").value = CamContrastValue;
					document.getElementById("CamSaturation").value = CamSaturationValue;
					document.getElementById("CamSaturationValue").value = CamSaturationValue;
					document.getElementById("CamWhiteBalance").value = CamWhiteBalanceValue;
					document.getElementById("CamWhiteBalanceValue").value = CamWhiteBalanceValue;
					document.getElementById("AutoWhitBlance").checked = CamautowhitebalanceValue;
					document.getElementById("auto_exposure").checked = Camauto_exposureValue;

					CameraMsg.brightness = Number(CamBrightnessValue);
					CameraMsg.contrast = Number(CamContrastValue);
					CameraMsg.saturation = Number(CamSaturationValue);
					CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
					CameraMsg.autowhitebalance = CamautowhitebalanceValue;
					CameraMsg.auto_exposure = Camauto_exposureValue;
					Camera.publish(CameraMsg);
				});
				document.getElementById("Camera").style.display = "inline";
				document.getElementById("container").style.height = "710px";
				document.getElementById("select").style.height = "400px";
				B_SetupCamera_Flag = false;
			} else {
				document.getElementById("Camera").style.display = "none";
				if (B_ColorModelForm_Flag == false) {
					document.getElementById("container").style.height = "810px";
					document.getElementById("select").style.height = "400px";
				} else {
					document.getElementById("container").style.height = "500px";
					document.getElementById("select").style.height = "180px";
				}
				B_SetupCamera_Flag = true;
			}
		}
		function changecolorlabel(newValue) {
			console.log(newValue);
			HSVreqrest.colorlabel = Number(newValue);
			HSVClient.callService(HSVreqrest, function (HSVresult) {
				document.getElementById("hminRange").value = HSVresult.hmin;
				document.getElementById("sminRange").value = HSVresult.smin;
				document.getElementById("bminRange").value = HSVresult.vmin;
				document.getElementById("hmaxRange").value = HSVresult.hmax;
				document.getElementById("smaxRange").value = HSVresult.smax;
				document.getElementById("bmaxRange").value = HSVresult.vmax;
				document.getElementById("hminValue").value = HSVresult.hmin;
				document.getElementById("sminValue").value = HSVresult.smin;
				document.getElementById("bminValue").value = HSVresult.vmin;
				document.getElementById("hmaxValue").value = HSVresult.hmax;
				document.getElementById("smaxValue").value = HSVresult.smax;
				document.getElementById("bmaxValue").value = HSVresult.vmax;
				HSVValuecmd.hmin = Number(document.getElementById("hminValue").value);
				HSVValuecmd.hmax = Number(document.getElementById("hmaxValue").value);
				HSVValuecmd.smin = Number(document.getElementById("sminValue").value);
				HSVValuecmd.smax = Number(document.getElementById("smaxValue").value);
				HSVValuecmd.vmin = Number(document.getElementById("bminValue").value);
				HSVValuecmd.vmax = Number(document.getElementById("bmaxValue").value);
				HSVValue_Topic.publish(HSVValuecmd);
			});
		}
		function showhminValue(newValue) {
			document.getElementById("hminValue").value = newValue;
			hmin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangehminValue(newValue) {
			document.getElementById("hminRange").value = newValue;
			hmin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showhmaxValue(newValue) {
			document.getElementById("hmaxValue").value = newValue;
			hmax = newValue;
			HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangehmaxValue(newValue) {
			document.getElementById("hmaxRange").value = newValue;
			hmax = newValue;
			HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showsminValue(newValue) {
			document.getElementById("sminValue").value = newValue;
			smin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangesminValue(newValue) {
			document.getElementById("sminRange").value = newValue;
			smin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showsmaxValue(newValue) {
			document.getElementById("smaxValue").value = newValue;
			smax = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangesmaxValue(newValue) {
			document.getElementById("smaxRange").value = newValue;
			smax = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showbminValue(newValue) {
			document.getElementById("bminValue").value = newValue;
			bmin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangebminValue(newValue) {
			document.getElementById("bminRange").value = newValue;
			bmin = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			//HSVValuecmd.vmax = Number(bmax);
			HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showbmaxValue(newValue) {
			document.getElementById("bmaxValue").value = newValue;
			bmax = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}

		function rangebmaxValue(newValue) {
			document.getElementById("bmaxRange").value = newValue;
			bmax = newValue;
			//HSVValuecmd.hmax = Number(hmax);
			//HSVValuecmd.hmin = Number(hmin);
			//HSVValuecmd.smax = Number(smax);
			//HSVValuecmd.smin = Number(smin);
			HSVValuecmd.vmax = Number(bmax);
			//HSVValuecmd.vmin = Number(bmin);
			HSVValue_Topic.publish(HSVValuecmd);
		}
		function showCamBrightness(newValue) {
			document.getElementById("CamBrightnessValue").value = newValue;
			CamBrightnessValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);

		}
		function rangeCamBrightnessValue(newValue) {
			document.getElementById("CamBrightness").value = newValue;
			CamBrightnessValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function showCamContrast(newValue) {
			document.getElementById("CamContrastValue").value = newValue;
			CamContrastValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);

		}
		function rangeCamContrastValue(newValue) {
			document.getElementById("CamContrast").value = newValue;
			CamContrastValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function showCamSaturation(newValue) {
			document.getElementById("CamSaturationValue").value = newValue;
			CamSaturationValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);

		}
		function rangeCamSaturationValue(newValue) {
			document.getElementById("CamSaturation").value = newValue;
			CamSaturationValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function showCamWhiteBalance(newValue) {
			document.getElementById("CamWhiteBalanceValue").value = newValue;
			CamWhiteBalanceValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);

		}
		function rangeCamWhiteBalanceValue(newValue) {
			document.getElementById("CamWhiteBalance").value = newValue;
			CamWhiteBalanceValue = newValue;
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function changeAutoWhitBlance() {
			if (document.getElementById("AutoWhitBlance").checked) {
				CamautowhitebalanceValue = true;
			} else {
				CamautowhitebalanceValue = false;
			}
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function changeauto_exposure() {
			if (document.getElementById("auto_exposure").checked) {
				Camauto_exposureValue = true;
			} else {
				Camauto_exposureValue = false;
			}
			CameraMsg.brightness = Number(CamBrightnessValue);
			CameraMsg.contrast = Number(CamContrastValue);
			CameraMsg.saturation = Number(CamSaturationValue);
			CameraMsg.whitebalance = Number(CamWhiteBalanceValue);
			CameraMsg.autowhitebalance = CamautowhitebalanceValue;
			CameraMsg.auto_exposure = Camauto_exposureValue;
			Camera.publish(CameraMsg);
		}
		function WebStart() {
			if (B_Start_Flag) {
				document.getElementById("B_Start").value = "Finsh";
				changecolorlabel(document.getElementById("colorlabel").value);
				B_Start_Flag = false;
				WebStartcmd.data = true;
				WebStart_Topic.publish(WebStartcmd);
			} else {
				document.getElementById("B_Start").value = "Start";
				B_Start_Flag = true;
				WebStartcmd.data = false;
				WebStart_Topic.publish(WebStartcmd);
			}
		}
		function showHorizontalPosition(newValue) {
			document.getElementById("HorizontalPositionValue").value = newValue;
			HeadPackagecmd.ID = Number(1);
			HeadPackagecmd.Position = Number(document.getElementById("HorizontalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("HorizontalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}

		function rangeHorizontalPosition(newValue) {
			document.getElementById("HorizontalPositionValue").value = newValue;
			HeadPackagecmd.ID = Number(1);
			HeadPackagecmd.Position = Number(document.getElementById("HorizontalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("HorizontalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}
		function showHorizontalSpeed(newValue) {
			document.getElementById("HorizontalSpeedValue").value = newValue;
			HeadPackagecmd.ID = Number(1);
			HeadPackagecmd.Position = Number(document.getElementById("HorizontalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("HorizontalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}

		function rangeHorizontalSpeed(newValue) {
			document.getElementById("HorizontalSpeedValue").value = newValue;
			HeadPackagecmd.ID = Number(1);
			HeadPackagecmd.Position = Number(document.getElementById("HorizontalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("HorizontalSpeedValue").valutde);
			Head_Topic.publish(HeadPackagecmd);
		}
		function showVerticalPosition(newValue) {
			document.getElementById("VerticalPositionValue").value = newValue;
			HeadPackagecmd.ID = Number(2);
			HeadPackagecmd.Position = Number(document.getElementById("VerticalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("VerticalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}

		function rangeVerticalPosition(newValue) {
			document.getElementById("VerticalPositionValue").value = newValue;
			HeadPackagecmd.ID = Number(2);
			HeadPackagecmd.Position = Number(document.getElementById("VerticalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("VerticalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}
		function showVerticalSpeed(newValue) {
			document.getElementById("VerticalSpeedValue").value = newValue;
			HeadPackagecmd.ID = Number(2);
			HeadPackagecmd.Position = Number(document.getElementById("VerticalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("VerticalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);

		}

		function rangeVerticalSpeed(newValue) {
			document.getElementById("VerticalSpeedValue").value = newValue;
			HeadPackagecmd.ID = Number(2);
			HeadPackagecmd.Position = Number(document.getElementById("VerticalPositionValue").value);
			HeadPackagecmd.Speed = Number(document.getElementById("VerticalSpeedValue").value);
			Head_Topic.publish(HeadPackagecmd);
		}
		function changeCamera() {
			CameraId_msg.data = Number(document.getElementById("Camera_Select").value);
			CameraId_Topic.publish(CameraId_msg);
		}

	</script>
	<style type="text/css">
		body {
			width: 1520px;
			height: 1000px;
			overflow: visible;
			background-image: url(./picture/red_filter_image.jpg);
			background-size: cover;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		}


		#container {
			background-color: #333;
			border: 2px black solid;
			width: 800px;
			height: 500px;
			margin: 20px auto;
			overflow: visible;
			color: white;
		}

		#div_orign_image {
			width: 320px;
			height: 240px;
			border: 1px #FFF solid;
			margin: 25px 32px 24px 32px;
			float: left;
			display: inline;
		}

		#div_color_image {
			width: 320px;
			height: 240px;
			border: 1px #FFF solid;
			margin: 25px 32px 24px 32px;
			float: right;
			display: inline;
		}

		#HSV_Range {
			width: 320px;
			height: 400px;
			border: 1px #FFF solid;
			margin: 10px 32px 0px 32px;
			float: right;
			display: none;
		}

		#select {
			width: 320px;
			height: 180px;
			margin: 10px 32px 0px 32px;
			float: left;
			display: inline;
		}

		#header {
			text-align: center;
			color: #FFFFFF;
			margin-top: 13px;
		}

		.text {
			margin: 1px 1px 1px 5px;
			font-size: 12px;
		}

		.ValueText {
			width: 38px;
			height: 20px;
		}

		.Range {
			width: 225px;
			height: 10px;
			margin: 6px 2px 6px 2px;

		}

		#B_ColorModelForm {
			width: 150px;
		}

		#Camera {
			display: none;
		}

		#B_Start {
			width: 50px;
		}
	</style>
	<title>HumanoidInterface</title>
</head>

<body>
	<!-- NAV BAR -->
	<ul>
		<li><a target="_blank" class="navbarright" href="WalkingInterface.html">Walking</a></li>
        <li><a target="_blank" class="navbarright" href="MotionControlInterface.html">Motion</a></li>
        <li><a target="_blank" style="text-decoration: underline;" class="navbarright" href="ImageProcessInterface.html">ImageProcess</a></li>
        <li><a target="_blank" class="navbarright" href="PIDcontroll.html">PIDcontroll</a></li>
		<li class="logo">
			<a target="_blank" href="index.html" class="logo"><img id="logoimg" src="./resources/TKU_ICLab/iclablogo-02.png"></a>
		</li>
	</ul>
	<br />
	<p id="connected" style="color:#00D600; display:none; font-size: 20px;">
		Connected
	</p>
	<form>

		<div id="head" align="center">
			<h1 id="header">Humanoid Interface</h1>
			<table>
				<tr>
					<td>
						<select style="height:25px; margin-right: 5px;" id="addressSelect">
							<option value="172.17.121.10">172.17.121.10</option>
							<option value="localhost">localhost</option>
						</select>
					</td>
					<td>
						<button type="button" style="width:110px ;height:25px;" id="changeAddressButton" onclick="enterAddress()">Enter Address</button>
					</td>
				</tr>
			</table>
		</div>
		<div id="container" align="center">
			<div id="div_orign_image">
				<img id="orign_image" style="-webkit-user-select: none; display:inline;" src="http://0.0.0.0:8080/stream_viewer?topic=/image_raw">
			</div>

			<div id="div_color_image">
				<img id="color_image" style="-webkit-user-select: none; display:inline;" src="http://172.17.121.10:8080/stream?topic=/processed_image">

			</div>

			<div id="HSV_Range">
				<table width="320">
					<tr>
						<td>
							<p class="text">Color Select : </p>
						</td>
						<td>
							<select id="colorlabel" onChange="changecolorlabel(this.value)">
								<option value="0">Orange Range</option>
								<option value="1">Yellow Range</option>
								<option value="2">Blue Range</option>
								<option value="3">Green Range</option>
								<option value="4">Black Range</option>
								<option value="5">Red Range</option>
								<option value="6">White Range</option>
								<option value="7">Others Range</option>
							</select>
						</td>
						<td align="center">
							<input type="button" class="Button" value="Reset" onClick="ResetColorModelFunction()"></input>
						</td>
						<td align="center">
							<input type="button" class="Button" value="Close" onClick="CloseColorModelFunction()"></input>
						</td>
					</tr>
				</table>
				<table>
					<tr>
						<td>
							<p class="text">Hue:</p>
						</td>
						<td><img src="./picture/HSVS255.jpg" width="230" height="20">
						</td>
					</tr>
					<tr>
						<td rowspan="2"><input type="text" class="ValueText" id="hminValue" size="12" value="0" onchange="rangehminValue(this.value)" /></td>
						<td><input class="Range" id="hminRange" name="hminRange" type="range" min="0" max="360" value="0" oninput="showhminValue(this.value)" /></td>
						<td rowspan="2"><input type="text" class="ValueText" id="hmaxValue" size="12" value="360" onchange="rangehmaxValue(this.value)" /></td>
					</tr>
					<tr>
						<td><input class="Range" id="hmaxRange" name="hmaxRange" type="range" min="0" max="360" value="360" oninput="showhmaxValue(this.value)" /></td>
					</tr>
					<tr>
						<td colspan="3">
							<p class="text">Saturation:</p>
						</td>
					</tr>
					<tr>
						<td rowspan="2"><input type="text" class="ValueText" id="sminValue" size="12" value="0" onchange="rangesminValue(this.value)" /></td>
						<td><input class="Range" id="sminRange" name="sminRange" type="range" min="0" max="255" value="0" oninput="showsminValue(this.value)" /></td>
						<td rowspan="2"><input type="text" class="ValueText" id="smaxValue" size="12" value="255" onchange="rangesmaxValue(this.value)" /></td>
					</tr>
					<tr>
						<td><input class="Range" id="smaxRange" name="smaxRange" type="range" min="0" max="255" value="255" oninput="showsmaxValue(this.value)" /></td>
					</tr>
					<tr>
						<td colspan="3">
							<p class="text">Brightness:</p>
						</td>
					</tr>
					<tr>
						<td rowspan="2"><input type="text" class="ValueText" id="bminValue" size="12" value="0" onchange="rangebminValue(this.value)" /></td>
						<td><input class="Range" id="bminRange" name="bminRange" type="range" min="0" max="255" value="0" oninput="showbminValue(this.value)" /></td>
						<td rowspan="2"><input type="text" class="ValueText" id="bmaxValue" size="12" value="255" onchange="rangebmaxValue(this.value)" /></td>
					</tr>
					<tr>
						<td><input class="Range" id="bmaxRange" name="bmaxRange" type="range" min="0" max="255" value="255" oninput="showbmaxValue(this.value)" /></td>
					</tr>
				</table>
				<table width="320">
					<tr>
						<td align="center">
							<input type="button" class="Button" id="SaveColorModel" value="Save" onClick="SaveColorModelFunction()" style="width:100px; height:30px"></input>
						</td>
						<td align="center">
							<input type="button" class="Button" id="BuildColorModel" value="Build" onClick="BuildColorModelFunction()" style="width:100px;height:30px"></input>
						</td>
					</tr>
				</table>
			</div>

			<div id="select">
				<div>
					<table width="320">
						<tr>
							<td>
								<input style="margin-right: 5px; height:25px;" type="button" class="Button" id="B_Start" value="Start" onClick="WebStart()"></input>
							</td>
							<td>
								<input style="margin-right: 5px; height:25px;" type="button" class="Button" id="B_ColorModelForm" value="Show Model Form"
								 onClick="ColorModelForm()"></input>
							</td>
							<td>
								<input style="margin-right: 5px; height:25px;" type="button" class="Button" id="B_Camera" value="Camera Setup"
								 onClick="CameraSetUp()"></input>
							</td>
						</tr>
					</table>
				</div>
				<div>
					<table width="320">
						<tr>
							<td colspan="3">
								<p class="text" style="font-size: 15px;">Horizontal:</p>
							</td>
						</tr>
						<tr>
							<td rowspan="2"><input style="width: 39px;" type="text" class="ValueText" id="HorizontalPositionValue" size="12" value="2048" onchange="rangeHorizontalPosition(this.value)" /></td>
							<td><input class="Range" id="HorizontalPositionRange" name="HorizontalPositionRange" type="range" min="0" max="4095"
								 value="2048" oninput="showHorizontalPosition(this.value)"/></td>
							<td rowspan="2"><input style="width: 39px;" type="text" class="ValueText" id="HorizontalSpeedValue" size="12" value="1" onchange="rangeHorizontalSpeed(this.value)" /></td>
						</tr>
						<tr>
							<td><input class="Range" id="HorizontalSpeedRange" name="HorizontalSpeedRange" type="range" min="1" max="1023"
								 value="1" oninput="showHorizontalSpeed(this.value)"/></td>
						</tr>
						<tr>
							<td colspan="3">
								<p class="text" style="font-size: 15px;">Vertical:</p>
							</td>
						</tr>
						<tr>
							<td rowspan="2"><input style="width: 39px;" type="text" class="ValueText" id="VerticalPositionValue" size="12" value="2048" onchange="rangeVerticalPosition(this.value)" /></td>
							<td><input class="Range" id="VerticalPositionRange" name="VerticalPositionRange" type="range" min="0" max="4095"
								 value="2048" oninput="showVerticalPosition(this.value)" /></td>
							<td rowspan="2"><input style="width: 39px;" type="text" class="ValueText" id="VerticalSpeedValue" size="12" value="1" onchange="rangeVerticalSpeed(this.value)" /></td>
						</tr>
						<tr>
							<td><input class="Range" id="VerticalSpeedRange" name="VerticalSpeedRange" type="range" min="1" max="1023" value="1"
								 oninput="showVerticalSpeed(this.value)" /></td>
						</tr>
					</table>
				</div>
				<div id="Camera">
					<div style="float:left; margin-left:8px;">
						<input type="checkbox" name="AutoWhitBlance" id="AutoWhitBlance" onclick="changeAutoWhitBlance()">Auto White_blance
					</div>
					<div style="float:right; margin-right:12px;">
						<input type="checkbox" name="auto_exposure" id="auto_exposure" onclick="changeauto_exposure()">Auto Exposure
					</div>
					<table width="320">
						<tr>
							<td colspan="3">
								<p class="text">Camera Brightness:</p>
							</td>
						</tr>
						<tr>
							<td width="25"></td>
							<td><input class="Range" id="CamBrightness" name="CamBrightness" type="range" min="-60" max="60" value="-15"
								 oninput="showCamBrightness(this.value)" /></td>
							<td><input type="text" class="ValueText" id="CamBrightnessValue" size="12" value="50" onchange="rangeCamBrightnessValue(this.value)" /></td>
						</tr>
						<tr>
							<td colspan="3">
								<p class="text">Camera Contrast:</p>
							</td>
						</tr>
						<tr>
							<td width="25"></td>
							<td><input class="Range" id="CamContrast" name="CamContrast" type="range" min="0" max="200" value="50" oninput="showCamContrast(this.value)" /></td>
							<td><input type="text" class="ValueText" id="CamContrastValue" size="12" value="5" onchange="rangeCamContrastValue(this.value)" /></td>
						</tr>
						<tr>
							<td colspan="3">
								<p class="text">Camera Saturation:</p>
							</td>
						</tr>
						<tr>
							<td width="25"></td>
							<td><input class="Range" id="CamSaturation" name="CamSaturation" type="range" min="0" max="255" value="50"
								 oninput="showCamSaturation(this.value)" /></td>
							<td><input type="text" class="ValueText" id="CamSaturationValue" size="12" value="50" onchange="rangeCamSaturationValue(this.value)" /></td>
						</tr>
						<tr>
							<td colspan="3">
								<p class="text">Camera WhiteBalance:</p>
							</td>
						</tr>
						<tr>
							<td width="25"></td>
							<td><input class="Range" id="CamWhiteBalance" name="CamWhiteBalance" type="range" min="0" max="8000" value="4000"
								 oninput="showCamWhiteBalance(this.value)" /></td>
							<td><input type="text" class="ValueText" id="CamWhiteBalanceValue" size="12" value="4000" onchange="rangeCamWhiteBalanceValue(this.value)" /></td>
						</tr>
					</table>
				</div>
			</div>

		</div>

	</form>
</body>

</html>
